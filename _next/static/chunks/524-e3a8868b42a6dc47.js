"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[524],{3524:(e,t,n)=>{let o,i,r;n.d(t,{H:()=>tj});var s,a,c,d,p,l,E,u,x,m,h,g,S,I,y,R,f,A,P,N,C,v,T,w,U,F,D,M,_=n(6882),b=n(9166),O=n(6372);!function(e){e.EmptySignInUsername="EmptySignInUsername",e.EmptySignInPassword="EmptySignInPassword",e.CustomAuthSignInPassword="CustomAuthSignInPassword",e.EmptySignUpUsername="EmptySignUpUsername",e.EmptySignUpPassword="EmptySignUpPassword",e.EmptyConfirmSignUpUsername="EmptyConfirmSignUpUsername",e.EmptyConfirmSignUpCode="EmptyConfirmSignUpCode",e.EmptyResendSignUpCodeUsername="EmptyresendSignUpCodeUsername",e.EmptyChallengeResponse="EmptyChallengeResponse",e.EmptyConfirmResetPasswordUsername="EmptyConfirmResetPasswordUsername",e.EmptyConfirmResetPasswordNewPassword="EmptyConfirmResetPasswordNewPassword",e.EmptyConfirmResetPasswordConfirmationCode="EmptyConfirmResetPasswordConfirmationCode",e.EmptyResetPasswordUsername="EmptyResetPasswordUsername",e.EmptyVerifyTOTPSetupCode="EmptyVerifyTOTPSetupCode",e.EmptyConfirmUserAttributeCode="EmptyConfirmUserAttributeCode",e.IncorrectMFAMethod="IncorrectMFAMethod",e.EmptyUpdatePassword="EmptyUpdatePassword"}(s||(s={}));let L={[s.EmptyChallengeResponse]:{message:"challengeResponse is required to confirmSignIn"},[s.EmptyConfirmResetPasswordUsername]:{message:"username is required to confirmResetPassword"},[s.EmptyConfirmSignUpCode]:{message:"code is required to confirmSignUp"},[s.EmptyConfirmSignUpUsername]:{message:"username is required to confirmSignUp"},[s.EmptyConfirmResetPasswordConfirmationCode]:{message:"confirmationCode is required to confirmResetPassword"},[s.EmptyConfirmResetPasswordNewPassword]:{message:"newPassword is required to confirmResetPassword"},[s.EmptyResendSignUpCodeUsername]:{message:"username is required to confirmSignUp"},[s.EmptyResetPasswordUsername]:{message:"username is required to resetPassword"},[s.EmptySignInPassword]:{message:"password is required to signIn"},[s.EmptySignInUsername]:{message:"username is required to signIn"},[s.EmptySignUpPassword]:{message:"password is required to signUp"},[s.EmptySignUpUsername]:{message:"username is required to signUp"},[s.CustomAuthSignInPassword]:{message:"A password is not needed when signing in with CUSTOM_WITHOUT_SRP",recoverySuggestion:"Do not include a password in your signIn call."},[s.IncorrectMFAMethod]:{message:"Incorrect MFA method was chosen. It should be either SMS, TOTP, or EMAIL",recoverySuggestion:"Try to pass SMS, TOTP, or EMAIL as the challengeResponse"},[s.EmptyVerifyTOTPSetupCode]:{message:"code is required to verifyTotpSetup"},[s.EmptyUpdatePassword]:{message:"oldPassword and newPassword are required to changePassword"},[s.EmptyConfirmUserAttributeCode]:{message:"confirmation code is required to confirmUserAttribute"}};!function(e){e.DEFAULT_MSG="Authentication Error",e.EMPTY_EMAIL="Email cannot be empty",e.EMPTY_PHONE="Phone number cannot be empty",e.EMPTY_USERNAME="Username cannot be empty",e.INVALID_USERNAME="The username should either be a string or one of the sign in types",e.EMPTY_PASSWORD="Password cannot be empty",e.EMPTY_CODE="Confirmation code cannot be empty",e.SIGN_UP_ERROR="Error creating account",e.NO_MFA="No valid MFA method provided",e.INVALID_MFA="Invalid MFA type",e.EMPTY_CHALLENGE="Challenge response cannot be empty",e.NO_USER_SESSION="Failed to get the session because the user is empty",e.NETWORK_ERROR="Network Error",e.DEVICE_CONFIG="Device tracking has not been configured in this User Pool",e.AUTOSIGNIN_ERROR="Please use your credentials to sign in",e.OAUTH_ERROR="Couldn't finish OAuth flow, check your User Pool HostedUI settings"}(a||(a={})),function(e){e.SignInException="SignInException",e.OAuthSignInError="OAuthSignInException"}(c||(c={}));var q=n(4228);function k(e,t){let{message:n,recoverySuggestion:o}=L[t];if(!e)throw new q.l({name:t,message:n,recoverySuggestion:o})}var B=n(2871);function H(e){return Object.entries(e).map(([e,t])=>({Name:e,Value:t}))}var V=n(247),z=n(4775);!function(e){e.ConcurrentModificationException="ConcurrentModificationException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException"}(d||(d={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(p||(p={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UsernameExistsException="UsernameExistsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(l||(l={})),function(e){e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(E||(E={})),function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyFailedAttemptsException="TooManyFailedAttemptsException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"}(u||(u={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(x||(x={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(m||(m={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(h||(h={})),function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"}(g||(g={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(S||(S={})),function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"}(I||(I={})),function(e){e.ExternalServiceException="ExternalServiceException",e.InternalErrorException="InternalErrorException",e.InvalidIdentityPoolConfigurationException="InvalidIdentityPoolConfigurationException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceConflictException="ResourceConflictException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException"}(y||(y={})),function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(R||(R={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException"}(f||(f={})),function(e){e.PasswordResetRequiredException="PasswordResetRequiredException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(A||(A={})),function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotFoundException="UserNotFoundException"}(P||(P={})),function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.MFAMethodNotFoundException="MFAMethodNotFoundException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(N||(N={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(C||(C={})),function(e){e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidPasswordException="InvalidPasswordException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UsernameExistsException="UsernameExistsException"}(v||(v={})),function(e){e.AliasExistsException="AliasExistsException",e.CodeDeliveryFailureException="CodeDeliveryFailureException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidEmailRoleAccessPolicyException="InvalidEmailRoleAccessPolicyException",e.InvalidLambdaResponseException="InvalidLambdaResponseException",e.InvalidParameterException="InvalidParameterException",e.InvalidSmsRoleAccessPolicyException="InvalidSmsRoleAccessPolicyException",e.InvalidSmsRoleTrustRelationshipException="InvalidSmsRoleTrustRelationshipException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UnexpectedLambdaException="UnexpectedLambdaException",e.UserLambdaValidationException="UserLambdaValidationException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(T||(T={})),function(e){e.CodeMismatchException="CodeMismatchException",e.EnableSoftwareTokenMFAException="EnableSoftwareTokenMFAException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.SoftwareTokenMFANotFoundException="SoftwareTokenMFANotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(w||(w={})),function(e){e.AliasExistsException="AliasExistsException",e.CodeMismatchException="CodeMismatchException",e.ExpiredCodeException="ExpiredCodeException",e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.LimitExceededException="LimitExceededException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(U||(U={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(F||(F={})),function(e){e.ForbiddenException="ForbiddenException",e.InternalErrorException="InternalErrorException",e.InvalidParameterException="InvalidParameterException",e.InvalidUserPoolConfigurationException="InvalidUserPoolConfigurationException",e.NotAuthorizedException="NotAuthorizedException",e.PasswordResetRequiredException="PasswordResetRequiredException",e.ResourceNotFoundException="ResourceNotFoundException",e.TooManyRequestsException="TooManyRequestsException",e.UserNotConfirmedException="UserNotConfirmedException",e.UserNotFoundException="UserNotFoundException"}(D||(D={}));var W=n(4979),$=n(3068);let G=async e=>{var t;let n=e.getConfig().Auth?.Cognito;(0,b.$y)(n);let o=await e.Auth.getTokens({forceRefresh:!1});(0,$.H0)(o);let{"cognito:username":i,sub:r}=o.idToken?.payload??{},s={username:i,userId:r},a=(t=o,t?.signInDetails);return a&&(s.signInDetails=a),s},K=async()=>G(_.H);var Y=n(4686);let J=(e,t)=>(0,Y.fE)({category:O.b7.Auth,action:e,...t});var Z=n(658),j=n(1413),Q=n(4134),X=n(8993),ee=n(2236),et=n(8305);let en=e=>(0,j.A)(Q.e,(0,X._)("AssociateSoftwareToken"),(0,ee.T)(),{...et.C,...e});var eo=n(8423);let ei=e=>(0,j.A)(Q.e,(0,X._)("RespondToAuthChallenge"),(0,ee.T)(),{...et.C,...e});var er=n(429),es=n(6010);async function ea(e){if(e.AccessToken){let t,n,o;let i=(0,b.Cq)(e.AccessToken),r=1e3*(i.payload.iat||0),s=new Date().getTime();e.RefreshToken&&(n=e.RefreshToken),e.IdToken&&(t=(0,b.Cq)(e.IdToken)),e?.NewDeviceMetadata&&(o=e.NewDeviceMetadata);let a={accessToken:i,idToken:t,refreshToken:n,clockDrift:r>0?r-s:0,deviceMetadata:o,username:e.username};e?.signInDetails&&(a.signInDetails=e.signInDetails),await es.o.setTokens({tokens:a})}else throw new er.x({message:"Invalid tokens",name:"InvalidTokens",recoverySuggestion:"Check Cognito UserPool settings"})}let ec=async()=>{try{V.YZ.dispatch("auth",{event:"signedIn",data:await K()},"Auth",V.U9)}catch(e){if(e.name===W.zz)throw new q.l({name:W.yA,message:"Unable to get user session following successful sign-in.",recoverySuggestion:"This most likely is due to auth tokens not being persisted. If you are using cookie store, please ensure cookies can be correctly set from your server."});throw e}};var ed=n(2966);let ep="CognitoSignInState",el={username:`${ep}.username`,challengeName:`${ep}.challengeName`,signInSession:`${ep}.signInSession`,expiry:`${ep}.expiry`},eE=e=>Number(e)<=Date.now(),eu=()=>{eg.dispatch({type:"RESET_STATE"})},ex=()=>{for(let e of Object.values(el))ed.pR.removeItem(e)},em=()=>({username:void 0,challengeName:void 0,signInSession:void 0}),eh=()=>{let e=ed.pR.getItem(el.expiry);if(!e||eE(e))return ex(),em();let t=ed.pR.getItem(el.username)??void 0;return{username:t,challengeName:ed.pR.getItem(el.challengeName)??void 0,signInSession:ed.pR.getItem(el.signInSession)??void 0}},eg=(e=>{let t=e(em(),{type:"SET_INITIAL_STATE"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}})((e,t)=>{switch(t.type){case"SET_SIGN_IN_SESSION":return eI({signInSession:t.value}),{...e,signInSession:t.value};case"SET_SIGN_IN_STATE":return eI(t.value),{...t.value};case"SET_CHALLENGE_NAME":return eI({challengeName:t.value}),{...e,challengeName:t.value};case"SET_USERNAME":return eI({username:t.value}),{...e,username:t.value};case"SET_INITIAL_STATE":return eh();case"RESET_STATE":return ex(),em();default:return e}});function eS(e){eg.dispatch({type:"SET_SIGN_IN_STATE",value:e})}let eI=({challengeName:e,signInSession:t,username:n})=>{n&&ed.pR.setItem(el.username,n),e&&ed.pR.setItem(el.challengeName,e),t&&(ed.pR.setItem(el.signInSession,t),ed.pR.setItem(el.expiry,String(Date.now()+18e4)))};var ey=n(811),eR=n(964);class ef extends er.x{constructor(e){super(e),this.constructor=ef,Object.setPrototypeOf(this,ef.prototype)}}!function(e){e.PasskeyNotSupported="PasskeyNotSupported",e.PasskeyAlreadyExists="PasskeyAlreadyExists",e.InvalidPasskeyRegistrationOptions="InvalidPasskeyRegistrationOptions",e.InvalidPasskeyAuthenticationOptions="InvalidPasskeyAuthenticationOptions",e.RelyingPartyMismatch="RelyingPartyMismatch",e.PasskeyRegistrationFailed="PasskeyRegistrationFailed",e.PasskeyRetrievalFailed="PasskeyRetrievalFailed",e.PasskeyRegistrationCanceled="PasskeyRegistrationCanceled",e.PasskeyAuthenticationCanceled="PasskeyAuthenticationCanceled",e.PasskeyOperationAborted="PasskeyOperationAborted"}(M||(M={}));let eA="Passkeys may not be supported on this device. Ensure your application is running in a secure context (HTTPS) and Web Authentication API is supported.",eP="User may have canceled the ceremony or another interruption has occurred. Check underlying error for details.",eN="Ensure your user pool is configured to support the WEB_AUTHN as an authentication factor.",eC={[M.PasskeyNotSupported]:{message:"Passkeys may not be supported on this device.",recoverySuggestion:eA},[M.InvalidPasskeyRegistrationOptions]:{message:"Invalid passkey registration options.",recoverySuggestion:eN},[M.InvalidPasskeyAuthenticationOptions]:{message:"Invalid passkey authentication options.",recoverySuggestion:eN},[M.PasskeyRegistrationFailed]:{message:"Device failed to create passkey.",recoverySuggestion:eA},[M.PasskeyRetrievalFailed]:{message:"Device failed to retrieve passkey.",recoverySuggestion:"Passkeys may not be available on this device. Try an alternative authentication factor like PASSWORD, EMAIL_OTP, or SMS_OTP."},[M.PasskeyAlreadyExists]:{message:"Passkey already exists in authenticator.",recoverySuggestion:"Proceed with existing passkey or try again after deleting the credential."},[M.PasskeyRegistrationCanceled]:{message:"Passkey registration ceremony has been canceled.",recoverySuggestion:eP},[M.PasskeyAuthenticationCanceled]:{message:"Passkey authentication ceremony has been canceled.",recoverySuggestion:eP},[M.PasskeyOperationAborted]:{message:"Passkey operation has been aborted.",recoverySuggestion:eP},[M.RelyingPartyMismatch]:{message:"Relying party does not match current domain.",recoverySuggestion:"Ensure relying party identifier matches current domain."}},ev=(0,ey.p)(eC,ef),eT=e=>{if(e instanceof ef)return e;if(e instanceof Error&&"NotAllowedError"===e.name){let{message:t,recoverySuggestion:n}=eC[M.PasskeyAuthenticationCanceled];return new ef({name:M.PasskeyAuthenticationCanceled,message:t,recoverySuggestion:n,underlyingError:e})}return ew(e)},ew=e=>{if(e instanceof Error){if("AbortError"===e.name){let{message:t,recoverySuggestion:n}=eC[M.PasskeyOperationAborted];return new ef({name:M.PasskeyOperationAborted,message:t,recoverySuggestion:n,underlyingError:e})}if("SecurityError"===e.name){let{message:t,recoverySuggestion:n}=eC[M.RelyingPartyMismatch];return new ef({name:M.RelyingPartyMismatch,message:t,recoverySuggestion:n,underlyingError:e})}}return new ef({name:eR.m.Unknown,message:"An unknown error has occurred.",underlyingError:e})};var eU=n(485);let eF=()=>(0,eU.B)()&&window.isSecureContext&&"credentials"in navigator&&"function"==typeof window.PublicKeyCredential;var eD=n(5248);let eM={convert(e,t={urlSafe:!1,skipPadding:!1}){let n="string"==typeof e?e:Array.from(e,e=>String.fromCodePoint(e)).join(""),o=(0,eD.xA)()(n);return t.urlSafe&&(o=o.replace(/\+/g,"-").replace(/\//g,"_")),t.skipPadding&&(o=o.replace(/=/g,"")),o}},e_=e=>eM.convert(new Uint8Array(e),{urlSafe:!0,skipPadding:!0});var eb=n(4194);let eO=e=>Uint8Array.from(eb.m.convert(e,{urlSafe:!0}),e=>e.charCodeAt(0)).buffer,eL=e=>{let t=eO(e.challenge),n=(e.allowCredentials||[]).map(e=>({...e,id:eO(e.id)}));return{...e,challenge:t,allowCredentials:n}},eq=e=>{let t={clientDataJSON:e_(e.response.clientDataJSON),authenticatorData:e_(e.response.authenticatorData),signature:e_(e.response.signature)};e.response.userHandle&&(t.userHandle=e_(e.response.userHandle));let n={id:e.id,rawId:e_(e.rawId),type:e.type,clientExtensionResults:e.getClientExtensionResults(),response:t};return e.authenticatorAttachment&&(n.authenticatorAttachment=e.authenticatorAttachment),n},ek=async e=>{try{let t=eF();ev(t,M.PasskeyNotSupported);let n=eL(e),o=await navigator.credentials.get({publicKey:n});return!function(e){ev(e&&e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAssertionResponse,M.PasskeyRetrievalFailed)}(o),eq(o)}catch(e){throw eT(e)}},eB=async()=>{let{userAgentData:e}=navigator;if(!e)return navigator.userAgent;let{platform:t="",platformVersion:n="",model:o="",architecture:i="",fullVersionList:r=[]}=await e.getHighEntropyValues(["platform","platformVersion","architecture","model","fullVersionList"]);return[t,n,i,o,t,r.map(e=>`${e.brand}/${e.version}`).join(";")].filter(e=>e).join(" ")||navigator.userAgent},eH=e=>(0,j.A)(Q.e,(0,X._)("ConfirmDevice"),(0,ee.T)(),{...et.C,...e}),eV={convert:e=>new TextEncoder().encode(e)};function ez(e,t){null!=e&&this.fromString(e,t)}function eW(){return new ez(null,null)}let e$="undefined"!=typeof navigator;e$&&"Microsoft Internet Explorer"===navigator.appName?(ez.prototype.am=function(e,t,n,o,i,r){let s=32767&t,a=t>>15;for(;--r>=0;){let t=32767&this[e],r=this[e++]>>15,c=a*t+r*s;i=((t=s*t+((32767&c)<<15)+n[o]+(0x3fffffff&i))>>>30)+(c>>>15)+a*r+(i>>>30),n[o++]=0x3fffffff&t}return i},o=30):e$&&"Netscape"!==navigator.appName?(ez.prototype.am=function(e,t,n,o,i,r){for(;--r>=0;){let r=t*this[e++]+n[o]+i;i=Math.floor(r/0x4000000),n[o++]=0x3ffffff&r}return i},o=26):(ez.prototype.am=function(e,t,n,o,i,r){let s=16383&t,a=t>>14;for(;--r>=0;){let t=16383&this[e],r=this[e++]>>14,c=a*t+r*s;i=((t=s*t+((16383&c)<<14)+n[o]+i)>>28)+(c>>14)+a*r,n[o++]=0xfffffff&t}return i},o=28),ez.prototype.DB=o,ez.prototype.DM=(1<<o)-1,ez.prototype.DV=1<<o,ez.prototype.FV=0x10000000000000,ez.prototype.F1=52-o,ez.prototype.F2=2*o-52;let eG=[];for(r=0,i=48;r<=9;++r)eG[i++]=r;for(r=10,i=97;r<36;++r)eG[i++]=r;for(r=10,i=65;r<36;++r)eG[i++]=r;function eK(e){return"0123456789abcdefghijklmnopqrstuvwxyz".charAt(e)}function eY(e){let t=eW();return t.fromInt(e),t}function eJ(e){let t,n=1;return 0!=(t=e>>>16)&&(e=t,n+=16),0!=(t=e>>8)&&(e=t,n+=8),0!=(t=e>>4)&&(e=t,n+=4),0!=(t=e>>2)&&(e=t,n+=2),0!=(t=e>>1)&&(e=t,n+=1),n}function eZ(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}eZ.prototype.convert=function(e){let t=eW();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(ez.ZERO)>0&&this.m.subTo(t,t),t},eZ.prototype.revert=function(e){let t=eW();return e.copyTo(t),this.reduce(t),t},eZ.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(let t=0;t<this.m.t;++t){let n=32767&e[t],o=n*this.mpl+((n*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(n=t+this.m.t,e[n]+=this.m.am(0,o,e,t,0,this.m.t);e[n]>=e.DV;)e[n]-=e.DV,e[++n]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},eZ.prototype.mulTo=function(e,t,n){e.multiplyTo(t,n),this.reduce(n)},eZ.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},ez.prototype.copyTo=function(e){for(let t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},ez.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},ez.prototype.fromString=function(e,t){let n;if(16===t)n=4;else if(8===t)n=3;else if(2===t)n=1;else if(32===t)n=5;else if(4===t)n=2;else throw Error("Only radix 2, 4, 8, 16, 32 are supported");this.t=0,this.s=0;let o=e.length,i=!1,r=0;for(;--o>=0;){let t=function(e,t){let n=eG[e.charCodeAt(t)];return null==n?-1:n}(e,o);if(t<0){"-"===e.charAt(o)&&(i=!0);continue}i=!1,0===r?this[this.t++]=t:r+n>this.DB?(this[this.t-1]|=(t&(1<<this.DB-r)-1)<<r,this[this.t++]=t>>this.DB-r):this[this.t-1]|=t<<r,(r+=n)>=this.DB&&(r-=this.DB)}this.clamp(),i&&ez.ZERO.subTo(this,this)},ez.prototype.clamp=function(){let e=this.s&this.DM;for(;this.t>0&&this[this.t-1]==e;)--this.t},ez.prototype.dlShiftTo=function(e,t){let n;for(n=this.t-1;n>=0;--n)t[n+e]=this[n];for(n=e-1;n>=0;--n)t[n]=0;t.t=this.t+e,t.s=this.s},ez.prototype.drShiftTo=function(e,t){for(let n=e;n<this.t;++n)t[n-e]=this[n];t.t=Math.max(this.t-e,0),t.s=this.s},ez.prototype.lShiftTo=function(e,t){let n;let o=e%this.DB,i=this.DB-o,r=(1<<i)-1,s=Math.floor(e/this.DB),a=this.s<<o&this.DM;for(n=this.t-1;n>=0;--n)t[n+s+1]=this[n]>>i|a,a=(this[n]&r)<<o;for(n=s-1;n>=0;--n)t[n]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},ez.prototype.rShiftTo=function(e,t){t.s=this.s;let n=Math.floor(e/this.DB);if(n>=this.t){t.t=0;return}let o=e%this.DB,i=this.DB-o,r=(1<<o)-1;t[0]=this[n]>>o;for(let e=n+1;e<this.t;++e)t[e-n-1]|=(this[e]&r)<<i,t[e-n]=this[e]>>o;o>0&&(t[this.t-n-1]|=(this.s&r)<<i),t.t=this.t-n,t.clamp()},ez.prototype.subTo=function(e,t){let n=0,o=0,i=Math.min(e.t,this.t);for(;n<i;)o+=this[n]-e[n],t[n++]=o&this.DM,o>>=this.DB;if(e.t<this.t){for(o-=e.s;n<this.t;)o+=this[n],t[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<e.t;)o-=e[n],t[n++]=o&this.DM,o>>=this.DB;o-=e.s}t.s=o<0?-1:0,o<-1?t[n++]=this.DV+o:o>0&&(t[n++]=o),t.t=n,t.clamp()},ez.prototype.multiplyTo=function(e,t){let n=this.abs(),o=e.abs(),i=n.t;for(t.t=i+o.t;--i>=0;)t[i]=0;for(i=0;i<o.t;++i)t[i+n.t]=n.am(0,o[i],t,i,0,n.t);t.s=0,t.clamp(),this.s!==e.s&&ez.ZERO.subTo(t,t)},ez.prototype.squareTo=function(e){let t=this.abs(),n=e.t=2*t.t;for(;--n>=0;)e[n]=0;for(n=0;n<t.t-1;++n){let o=t.am(n,t[n],e,2*n,0,1);(e[n+t.t]+=t.am(n+1,2*t[n],e,2*n+1,o,t.t-n-1))>=t.DV&&(e[n+t.t]-=t.DV,e[n+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(n,t[n],e,2*n,0,1)),e.s=0,e.clamp()},ez.prototype.divRemTo=function(e,t,n){let o=e.abs();if(o.t<=0)return;let i=this.abs();if(i.t<o.t){null!=t&&t.fromInt(0),null!=n&&this.copyTo(n);return}null===n&&(n=eW());let r=eW(),s=this.s,a=e.s,c=this.DB-eJ(o[o.t-1]);c>0?(o.lShiftTo(c,r),i.lShiftTo(c,n)):(o.copyTo(r),i.copyTo(n));let d=r.t,p=r[d-1];if(0===p)return;let l=p*(1<<this.F1)+(d>1?r[d-2]>>this.F2:0),E=this.FV/l,u=(1<<this.F1)/l,x=1<<this.F2,m=n.t,h=m-d,g=null===t?eW():t;for(r.dlShiftTo(h,g),n.compareTo(g)>=0&&(n[n.t++]=1,n.subTo(g,n)),ez.ONE.dlShiftTo(d,g),g.subTo(r,r);r.t<d;)r[r.t++]=0;for(;--h>=0;){let e=n[--m]===p?this.DM:Math.floor(n[m]*E+(n[m-1]+x)*u);if((n[m]+=r.am(0,e,n,h,0,d))<e)for(r.dlShiftTo(h,g),n.subTo(g,n);n[m]<--e;)n.subTo(g,n)}null!==t&&(n.drShiftTo(d,t),s!==a&&ez.ZERO.subTo(t,t)),n.t=d,n.clamp(),c>0&&n.rShiftTo(c,n),s<0&&ez.ZERO.subTo(n,n)},ez.prototype.invDigit=function(){if(this.t<1)return 0;let e=this[0];if((1&e)==0)return 0;let t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},ez.prototype.addTo=function(e,t){let n=0,o=0,i=Math.min(e.t,this.t);for(;n<i;)o+=this[n]+e[n],t[n++]=o&this.DM,o>>=this.DB;if(e.t<this.t){for(o+=e.s;n<this.t;)o+=this[n],t[n++]=o&this.DM,o>>=this.DB;o+=this.s}else{for(o+=this.s;n<e.t;)o+=e[n],t[n++]=o&this.DM,o>>=this.DB;o+=e.s}t.s=o<0?-1:0,o>0?t[n++]=o:o<-1&&(t[n++]=this.DV+o),t.t=n,t.clamp()},ez.prototype.toString=function(e){let t,n;if(this.s<0)return"-"+this.negate().toString(e);if(16==e)t=4;else if(8===e)t=3;else if(2===e)t=1;else if(32===e)t=5;else if(4===e)t=2;else throw Error("Only radix 2, 4, 8, 16, 32 are supported");let o=(1<<t)-1,i=!1,r="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(n=this[s]>>a)>0&&(i=!0,r=eK(n));s>=0;)a<t?n=(this[s]&(1<<a)-1)<<t-a|this[--s]>>(a+=this.DB-t):(n=this[s]>>(a-=t)&o,a<=0&&(a+=this.DB,--s)),n>0&&(i=!0),i&&(r+=eK(n));return i?r:"0"},ez.prototype.negate=function(){let e=eW();return ez.ZERO.subTo(this,e),e},ez.prototype.abs=function(){return this.s<0?this.negate():this},ez.prototype.compareTo=function(e){let t=this.s-e.s;if(0!=t)return t;let n=this.t;if(0!=(t=n-e.t))return this.s<0?-t:t;for(;--n>=0;)if(0!=(t=this[n]-e[n]))return t;return 0},ez.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+eJ(this[this.t-1]^this.s&this.DM)},ez.prototype.mod=function(e){let t=eW();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(ez.ZERO)>0&&e.subTo(t,t),t},ez.prototype.equals=function(e){return 0===this.compareTo(e)},ez.prototype.add=function(e){let t=eW();return this.addTo(e,t),t},ez.prototype.subtract=function(e){let t=eW();return this.subTo(e,t),t},ez.prototype.multiply=function(e){let t=eW();return this.multiplyTo(e,t),t},ez.prototype.divide=function(e){let t=eW();return this.divRemTo(e,t,null),t},ez.prototype.modPow=function(e,t,n){let o,i,r,s=e.bitLength(),a=eY(1),c=new eZ(t);if(s<=0)return a;let d=[],p=3,l=(o=s<18?1:s<48?3:s<144?4:s<768?5:6)-1,E=(1<<o)-1;if(d[1]=c.convert(this),o>1){let e=eW();for(c.sqrTo(d[1],e);p<=E;)d[p]=eW(),c.mulTo(e,d[p-2],d[p]),p+=2}let u=e.t-1,x=!0,m=eW();for(s=eJ(e[u])-1;u>=0;){for(s>=l?i=e[u]>>s-l&E:(i=(e[u]&(1<<s+1)-1)<<l-s,u>0&&(i|=e[u-1]>>this.DB+s-l)),p=o;(1&i)==0;)i>>=1,--p;if((s-=p)<0&&(s+=this.DB,--u),x)d[i].copyTo(a),x=!1;else{for(;p>1;)c.sqrTo(a,m),c.sqrTo(m,a),p-=2;p>0?c.sqrTo(a,m):(r=a,a=m,m=r),c.mulTo(m,d[i],a)}for(;u>=0&&(e[u]&1<<s)==0;)c.sqrTo(a,m),r=a,a=m,m=r,--s<0&&(s=this.DB-1,--u)}let h=c.revert(a);return n(null,h),h},ez.ZERO=eY(0),ez.ONE=eY(1);let ej=async({a:e,g:t,k:n,x:o,B:i,N:r,U:s})=>new Promise((a,c)=>{t.modPow(o,r,(t,d)=>{if(t){c(t);return}i.subtract(n.multiply(d)).modPow(e.add(s.multiply(o)),r,(e,t)=>{if(e){c(e);return}a(t.mod(r))})})}),eQ={},eX={};for(let e=0;e<256;e++){let t=e.toString(16).toLowerCase();1===t.length&&(t=`0${t}`),eQ[e]=t,eX[t]=e}let e0=e=>{if(e.length%2!=0)throw Error("Hex encoded strings must have an even number length");let t=new Uint8Array(e.length/2);for(let n=0;n<e.length;n+=2){let o=e.slice(n,n+2).toLowerCase();if(o in eX)t[n/2]=eX[o];else throw Error(`Cannot decode unrecognized sequence ${o} as hexadecimal`)}return t};var e1=n(3858);let e2=e=>{let t="";for(let n=0;n<e.byteLength;n++)t+=eQ[e[n]];return t},e6=e=>{let t=new e1.I;t.update(e);let n=e2(t.digestSync());return Array(64-n.length).join("0")+n},e5=e=>e6(e0(e)),e3=/^[89a-f]/i,e4=e=>{if(!(e instanceof ez))throw Error("Not a BigInteger");let t=0>e.compareTo(ez.ZERO),n=e.abs().toString(16);return n=n.length%2!=0?`0${n}`:n,n=e3.test(n)?`00${n}`:n,t&&(n=new ez(n.split("").map(e=>{let t=15&~parseInt(e,16);return"0123456789ABCDEF".charAt(t)}).join(""),16).add(ez.ONE).toString(16)).toUpperCase().startsWith("FF8")&&(n=n.substring(2)),n},e8=({A:e,B:t})=>{let n=new ez(e5(e4(e)+e4(t)),16);if(n.equals(ez.ZERO))throw Error("U cannot be zero.");return n},e7=(e,t,n)=>{let o=new e1.I(t);o.update(e);let i=o.digestSync(),r=new e1.I(i);return r.update(n),r.digestSync().slice(0,16)};class e9{constructor(e,t){this.words=[];let n=e;n=this.words=n||[],void 0!==t?this.sigBytes=t:this.sigBytes=4*n.length}random(e){let t=[];for(let n=0;n<e;n+=4)t.push((0,eD.MY)().getRandomValues(new Uint32Array(1))[0]);return new e9(t,e)}toString(){return function(e){let{words:t}=e,{sigBytes:n}=e,o=[];for(let e=0;e<n;e++){let n=t[e>>>2]>>>24-e%4*8&255;o.push((n>>>4).toString(16)),o.push((15&n).toString(16))}return o.join("")}(this)}}let te=e=>e0(new e9().random(e).toString()),tt=()=>eM.convert(te(40));class tn{constructor({userPoolName:e,a:t,g:n,A:o,N:i}){this.encoder=eV,this.userPoolName=e,this.a=t,this.g=n,this.A=o,this.N=i,this.k=new ez(e5(`${e4(i)}${e4(n)}`),16)}getRandomPassword(){if(!this.randomPassword)throw new q.l({name:"EmptyBigIntegerRandomPassword",message:"random password is empty"});return this.randomPassword}getSaltToHashDevices(){if(!this.saltToHashDevices)throw new q.l({name:"EmptyBigIntegersaltToHashDevices",message:"saltToHashDevices is empty"});return this.saltToHashDevices}getVerifierDevices(){if(!this.verifierDevices)throw new q.l({name:"EmptyBigIntegerVerifierDevices",message:"verifyDevices is empty"});return this.verifierDevices}async generateHashDevice(e,t){this.randomPassword=tt();let n=e6(`${e}${t}:${this.randomPassword}`),o=e2(te(16));return this.saltToHashDevices=e4(new ez(o,16)),new Promise((e,t)=>{this.g.modPow(new ez(e5(this.saltToHashDevices+n),16),this.N,(n,o)=>{if(n){t(n);return}this.verifierDevices=e4(o),e()})})}async getPasswordAuthenticationKey({username:e,password:t,serverBValue:n,salt:o}){if(n.mod(this.N).equals(ez.ZERO))throw Error("B cannot be zero.");let i=e8({A:this.A,B:n}),r=e6(`${this.userPoolName}${e}:${t}`),s=new ez(e5(e4(o)+r),16),a=await ej({a:this.a,g:this.g,k:this.k,x:s,B:n,N:this.N,U:i}),c=this.encoder.convert("Caldera Derived Key"),d=this.encoder.convert("\x01"),p=new Uint8Array(c.byteLength+d.byteLength);return p.set(c,0),p.set(d,c.byteLength),e7(e0(e4(a)),e0(e4(i)),p)}}let to=async({a:e,g:t,N:n})=>new Promise((o,i)=>{t.modPow(e,n,(e,t)=>{if(e){i(e);return}if(t.mod(n).equals(ez.ZERO)){i(Error("Illegal parameter. A mod N cannot be 0."));return}o(t)})}),ti=async e=>{let t=new ez("FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F14374FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7EDEE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF0598DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3BE39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF6955817183995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E208E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF",16),n=new ez("2",16),o=tr(),i=await to({a:o,g:n,N:t});return new tn({userPoolName:e,a:o,g:n,A:i,N:t})},tr=()=>new ez(e2(te(128)),16);async function ts({userPoolId:e,userPoolEndpoint:t,newDeviceMetadata:n,accessToken:o}){if(!n)return;let i=e.split("_")[1]||"",r=await ti(i),s=n?.DeviceKey,a=n?.DeviceGroupKey;try{await r.generateHashDevice(a??"",s??"")}catch(e){return}let c={Salt:eM.convert(e0(r.getSaltToHashDevices())),PasswordVerifier:eM.convert(e0(r.getVerifierDevices()))},d=r.getRandomPassword();try{let i=eH({endpointResolver:(0,eo.o)({endpointOverride:t})});return await i({region:(0,B.J)(e)},{AccessToken:o,DeviceName:await eB(),DeviceKey:n?.DeviceKey,DeviceSecretVerifierConfig:c}),{deviceKey:s,deviceGroupKey:a,randomPassword:d}}catch(e){return}}async function ta(e){let t=_.H.getConfig().Auth?.Cognito;(0,b.$y)(t);let{username:n,signInSession:o,signInDetails:i,challengeName:r}=eg.getState();if("WEB_AUTHN"!==r||!n)throw new q.l({name:c.SignInException,message:"Unable to proceed due to invalid sign in state."});let{CREDENTIAL_REQUEST_OPTIONS:s}=e;ev(!!s,M.InvalidPasskeyAuthenticationOptions);let a=await ek(JSON.parse(s)),d=ei({endpointResolver:(0,eo.o)({endpointOverride:t.userPoolEndpoint})}),{ChallengeName:p,ChallengeParameters:l,AuthenticationResult:E,Session:u}=await d({region:(0,B.J)(t.userPoolId),userAgentValue:J(O.BM.ConfirmSignIn)},{ChallengeName:"WEB_AUTHN",ChallengeResponses:{USERNAME:n,CREDENTIAL:JSON.stringify(a)},ClientId:t.userPoolClientId,Session:o});if(eS({signInSession:u,username:n,challengeName:p,signInDetails:i}),E)return await ea({...E,username:n,NewDeviceMetadata:await ts({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:E.NewDeviceMetadata,accessToken:E.AccessToken}),signInDetails:i}),eg.dispatch({type:"RESET_STATE"}),await ec(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};if("WEB_AUTHN"===p)throw new q.l({name:c.SignInException,message:"Sequential WEB_AUTHN challenges returned from underlying service cannot be handled."});return{challengeName:p,challengeParameters:l}}var tc=n(8829);let td=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],tp=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],tl=()=>{let e=new Date,t=tp[e.getUTCDay()],n=td[e.getUTCMonth()],o=e.getUTCDate(),i=e.getUTCHours();i<10&&(i=`0${i}`);let r=e.getUTCMinutes();r<10&&(r=`0${r}`);let s=e.getUTCSeconds();s<10&&(s=`0${s}`);let a=e.getUTCFullYear();return`${t} ${n} ${o} ${i}:${r}:${s} UTC ${a}`},tE=({userPoolName:e,username:t,challengeParameters:n,dateNow:o,hkdf:i})=>{let r=eV.convert(e),s=eV.convert(t),a=tu(n.SECRET_BLOCK),c=eV.convert(o),d=new Uint8Array(r.byteLength+s.byteLength+a.byteLength+c.byteLength);d.set(r,0),d.set(s,r.byteLength),d.set(a,r.byteLength+s.byteLength),d.set(c,r.byteLength+s.byteLength+a.byteLength);let p=new e1.I(i);p.update(d);let l=p.digestSync();return eM.convert(l)},tu=e=>{let t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/-/g,"+").replace(/_/g,"/"),o=eb.m.convert(n),i=new Uint8Array(o.length);for(let e=0;e<o.length;++e)i[e]=o.charCodeAt(e);return i};async function tx({username:e,config:t,clientMetadata:n,session:o,tokenOrchestrator:i}){let{userPoolId:r,userPoolEndpoint:s}=t,a=t.userPoolClientId,c=await i?.getDeviceMetadata(e);(0,$.O_)(c);let d=await ti(c.deviceGroupKey),p={USERNAME:e,SRP_A:d.A.toString(16),DEVICE_KEY:c.deviceKey},l=ei({endpointResolver:(0,eo.o)({endpointOverride:s})}),{ChallengeParameters:E,Session:u}=await l({region:(0,B.J)(r)},{ChallengeName:"DEVICE_SRP_AUTH",ClientId:a,ChallengeResponses:p,ClientMetadata:n,Session:o});return tm(e,E,n,u,d,t,i)}async function tm(e,t,n,o,i,{userPoolId:r,userPoolClientId:s,userPoolEndpoint:a},c){let d=await c?.getDeviceMetadata(e);(0,$.O_)(d);let p=new ez(t?.SRP_B,16),l=new ez(t?.SALT,16),{deviceKey:E}=d,{deviceGroupKey:u}=d,x=await i.getPasswordAuthenticationKey({username:d.deviceKey,password:d.randomPassword,serverBValue:p,salt:l}),m=tl(),h={USERNAME:t?.USERNAME??e,PASSWORD_CLAIM_SECRET_BLOCK:t?.SECRET_BLOCK,TIMESTAMP:m,PASSWORD_CLAIM_SIGNATURE:tE({username:E,userPoolName:u,challengeParameters:t,dateNow:m,hkdf:x}),DEVICE_KEY:E},g=(0,tc.d)({username:e,userPoolId:r,userPoolClientId:s});return ei({endpointResolver:(0,eo.o)({endpointOverride:a})})({region:(0,B.J)(r)},{ChallengeName:"DEVICE_PASSWORD_VERIFIER",ClientId:s,ChallengeResponses:h,Session:o,ClientMetadata:n,UserContextData:g})}async function th(e,t,n,o,i,r,s){let{userPoolId:a,userPoolClientId:c,userPoolEndpoint:d}=r,p=a?.split("_")[1]||"",l=new ez(t?.SRP_B,16),E=new ez(t?.SALT,16),u=t?.USER_ID_FOR_SRP;if(!u)throw new q.l({name:"EmptyUserIdForSRPException",message:"USER_ID_FOR_SRP was not found in challengeParameters"});let x=await i.getPasswordAuthenticationKey({username:u,password:e,serverBValue:l,salt:E}),m=tl(),h={USERNAME:u,PASSWORD_CLAIM_SECRET_BLOCK:t?.SECRET_BLOCK,TIMESTAMP:m,PASSWORD_CLAIM_SIGNATURE:tE({username:u,userPoolName:p,challengeParameters:t,dateNow:m,hkdf:x})},g=await s.getDeviceMetadata(u);g&&g.deviceKey&&(h.DEVICE_KEY=g.deviceKey);let S=(0,tc.d)({username:u,userPoolId:a,userPoolClientId:c}),I=ei({endpointResolver:(0,eo.o)({endpointOverride:d})}),y=await I({region:(0,B.J)(a)},{ChallengeName:"PASSWORD_VERIFIER",ChallengeResponses:h,ClientMetadata:n,Session:o,ClientId:c,UserContextData:S});return"DEVICE_SRP_AUTH"===y.ChallengeName?tx({username:u,config:r,clientMetadata:n,session:y.Session,tokenOrchestrator:s}):y}async function tg(e,t,n,o){try{return await e(...t)}catch(i){if(i instanceof q.l&&"ResourceNotFoundException"===i.name&&i.message.includes("Device does not exist."))return await o.clearDeviceMetadata(n),e(...t);throw i}}function tS(e){let{dispatch:t}=eg;t({type:"SET_USERNAME",value:e})}async function tI({username:e,password:t,clientMetadata:n,config:o,tokenOrchestrator:i,authFlow:r,preferredChallenge:s}){let{userPoolId:a,userPoolClientId:c,userPoolEndpoint:d}=o,p=a?.split("_")[1]||"",l=await ti(p),E={USERNAME:e,SRP_A:l.A.toString(16)};"USER_AUTH"===r&&s&&(E.PREFERRED_CHALLENGE=s);let u=(0,tc.d)({username:e,userPoolId:a,userPoolClientId:c}),x=(0,Z.R)({endpointResolver:(0,eo.o)({endpointOverride:d})}),m=await x({region:(0,B.J)(a),userAgentValue:J(O.BM.SignIn)},{AuthFlow:r,AuthParameters:E,ClientMetadata:n,ClientId:c,UserContextData:u}),{ChallengeParameters:h,Session:g}=m,S=h?.USERNAME??e;return(tS(S),"PASSWORD_VERIFIER"===m.ChallengeName)?tg(th,[t,h,n,g,l,o,i],S,i):m}let ty="userAttributes.";async function tR(e,t,n,o,i){let{userPoolClientId:r,userPoolId:s,userPoolEndpoint:a}=o,c={USERNAME:e,PASSWORD:t},d=await i.getDeviceMetadata(e);d&&d.deviceKey&&(c.DEVICE_KEY=d.deviceKey);let p=(0,tc.d)({username:e,userPoolId:s,userPoolClientId:r}),l=(0,Z.R)({endpointResolver:(0,eo.o)({endpointOverride:a})}),E=await l({region:(0,B.J)(s),userAgentValue:J(O.BM.SignIn)},{AuthFlow:"USER_PASSWORD_AUTH",AuthParameters:c,ClientMetadata:n,ClientId:r,UserContextData:p}),u=E.ChallengeParameters?.USERNAME??E.ChallengeParameters?.USER_ID_FOR_SRP??e;return(tS(u),"DEVICE_SRP_AUTH"===E.ChallengeName)?tx({username:u,config:o,clientMetadata:n,session:E.Session,tokenOrchestrator:i}):E}async function tf(e,t,n,o,i){return tI({username:e,password:t,clientMetadata:n,config:o,tokenOrchestrator:i,authFlow:"USER_SRP_AUTH"})}async function tA(e,t,n,o){let{userPoolClientId:i,userPoolId:r,userPoolEndpoint:s}=n,a={USERNAME:e},c=await o.getDeviceMetadata(e);c&&c.deviceKey&&(a.DEVICE_KEY=c.deviceKey);let d=(0,tc.d)({username:e,userPoolId:r,userPoolClientId:i}),p=(0,Z.R)({endpointResolver:(0,eo.o)({endpointOverride:s})}),l=await p({region:(0,B.J)(r),userAgentValue:J(O.BM.SignIn)},{AuthFlow:"CUSTOM_AUTH",AuthParameters:a,ClientMetadata:t,ClientId:i,UserContextData:d}),E=l.ChallengeParameters?.USERNAME??e;return(tS(E),"DEVICE_SRP_AUTH"===l.ChallengeName)?tx({username:E,config:n,clientMetadata:t,session:l.Session,tokenOrchestrator:o}):l}async function tP(e,t,n,o,i){(0,b.$y)(o);let{userPoolId:r,userPoolClientId:s,userPoolEndpoint:a}=o,c=r?.split("_")[1]||"",d=await ti(c),p={USERNAME:e,SRP_A:d.A.toString(16),CHALLENGE_NAME:"SRP_A"},l=(0,tc.d)({username:e,userPoolId:r,userPoolClientId:s}),E=(0,Z.R)({endpointResolver:(0,eo.o)({endpointOverride:a})}),{ChallengeParameters:u,Session:x}=await E({region:(0,B.J)(r),userAgentValue:J(O.BM.SignIn)},{AuthFlow:"CUSTOM_AUTH",AuthParameters:p,ClientMetadata:n,ClientId:s,UserContextData:l}),m=u?.USERNAME??e;return tS(m),tg(th,[t,u,n,x,d,o,i],m,i)}async function tN(e){var t,n,o;let{challengeName:i,challengeParameters:r,availableChallenges:s}=e,a=_.H.getConfig().Auth?.Cognito;switch((0,b.$y)(a),i){case"CUSTOM_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_CUSTOM_CHALLENGE",additionalInfo:r}};case"MFA_SETUP":{let{signInSession:e,username:o}=eg.getState(),i=tT(tw(r.MFAS_CAN_SETUP))||[],s=i.filter(e=>"EMAIL"===e||"TOTP"===e),d=s.includes("TOTP"),p=s.includes("EMAIL");if(d&&p)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SETUP_SELECTION",allowedMFATypes:s}};if(p)return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_EMAIL_SETUP"}};if(d){let i=en({endpointResolver:(0,eo.o)({endpointOverride:a.userPoolEndpoint})}),{Session:r,SecretCode:s}=await i({region:(0,B.J)(a.userPoolId)},{Session:e});return eg.dispatch({type:"SET_SIGN_IN_SESSION",value:r}),{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_TOTP_SETUP",totpSetupDetails:(t=s,n=o,{sharedSecret:t,getSetupUri:(e,o)=>{let i=`otpauth://totp/${e}:${o??n}?secret=${t}&issuer=${e}`;return new z.o(i)}})}}}throw new q.l({name:c.SignInException,message:`Cannot initiate MFA setup from available types: ${i}`})}case"NEW_PASSWORD_REQUIRED":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_NEW_PASSWORD_REQUIRED",missingAttributes:(o=r.requiredAttributes)?JSON.parse(o).map(e=>e.includes(ty)?e.replace(ty,""):e):[]}};case"SELECT_MFA_TYPE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_MFA_SELECTION",allowedMFATypes:tT(tw(r.MFAS_CAN_CHOOSE))}};case"SMS_OTP":case"SMS_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_SMS_CODE",codeDeliveryDetails:{deliveryMedium:r.CODE_DELIVERY_DELIVERY_MEDIUM,destination:r.CODE_DELIVERY_DESTINATION}}};case"SOFTWARE_TOKEN_MFA":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_TOTP_CODE"}};case"EMAIL_OTP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_EMAIL_CODE",codeDeliveryDetails:{deliveryMedium:r.CODE_DELIVERY_DELIVERY_MEDIUM,destination:r.CODE_DELIVERY_DESTINATION}}};case"WEB_AUTHN":{let e=await ta(r);if("isSignedIn"in e&&"nextStep"in e)return e;return tN(e)}case"PASSWORD":case"PASSWORD_SRP":return{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_IN_WITH_PASSWORD"}};case"SELECT_CHALLENGE":return{isSignedIn:!1,nextStep:{signInStep:"CONTINUE_SIGN_IN_WITH_FIRST_FACTOR_SELECTION",availableChallenges:s}}}throw new q.l({name:c.SignInException,message:`An error occurred during the sign in process. ${i} challengeName returned by the underlying service was not addressed.`})}function tC(e){return e===A.PasswordResetRequiredException?{isSignedIn:!1,nextStep:{signInStep:"RESET_PASSWORD"}}:e===A.UserNotConfirmedException?{isSignedIn:!1,nextStep:{signInStep:"CONFIRM_SIGN_UP"}}:void 0}function tv(e){return"SMS_MFA"===e?"SMS":"SOFTWARE_TOKEN_MFA"===e?"TOTP":"EMAIL_OTP"===e?"EMAIL":void 0}function tT(e){if(e)return e.map(tv).filter(Boolean)}function tw(e){return e?JSON.parse(e):[]}async function tU(){let e;try{e=await K()}catch(e){}if(e&&e.userId&&e.username)throw new q.l({name:W.z0,message:"There is already a signed in user.",recoverySuggestion:"Call signOut before calling signIn again."})}function tF(e){return eg.getState().username??e}var tD=n(5419);async function tM(e){let t=_.H.getConfig().Auth?.Cognito;(0,b.$y)(t);let{username:n,password:o,options:i}=e,r={loginId:n,authFlowType:"CUSTOM_WITHOUT_SRP"},a=i?.clientMetadata;k(!!n,s.EmptySignInUsername),k(!o,s.CustomAuthSignInPassword);try{let{ChallengeName:e,ChallengeParameters:o,AuthenticationResult:i,Session:s}=await tg(tA,[n,a,t,es.o],n,es.o),c=tF(n);if(eS({signInSession:s,username:c,challengeName:e,signInDetails:r}),i)return await ea({username:c,...i,NewDeviceMetadata:await ts({userPoolId:t.userPoolId,userPoolEndpoint:t.userPoolEndpoint,newDeviceMetadata:i.NewDeviceMetadata,accessToken:i.AccessToken}),signInDetails:r}),eu(),await ec(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};return tN({challengeName:e,challengeParameters:o})}catch(t){eu(),(0,tD.e)(t);let e=tC(t.name);if(e)return e;throw t}}async function t_(e){let{username:t,password:n,options:o}=e,i={loginId:t,authFlowType:"CUSTOM_WITH_SRP"},r=_.H.getConfig().Auth?.Cognito;(0,b.$y)(r);let a=o?.clientMetadata;k(!!t,s.EmptySignInUsername),k(!!n,s.EmptySignInPassword);try{let{ChallengeName:e,ChallengeParameters:o,AuthenticationResult:s,Session:c}=await tP(t,n,a,r,es.o),d=tF(t);if(eS({signInSession:c,username:d,challengeName:e,signInDetails:i}),s)return await ea({username:d,...s,NewDeviceMetadata:await ts({userPoolId:r.userPoolId,userPoolEndpoint:r.userPoolEndpoint,newDeviceMetadata:s.NewDeviceMetadata,accessToken:s.AccessToken}),signInDetails:i}),eu(),await ec(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};return tN({challengeName:e,challengeParameters:o})}catch(t){eu(),(0,tD.e)(t);let e=tC(t.name);if(e)return e;throw t}}function tb(){return{active:!1}}let tO=(e=>{let t=e(tb(),{type:"RESET"});return{getState:()=>t,dispatch:n=>{t=e(t,n)}}})((e,t)=>{switch(t.type){case"SET_USERNAME":return{...e,username:t.value};case"SET_SESSION":return{...e,session:t.value};case"START":return{...e,active:!0};case"RESET":return tb();default:return e}});function tL(e=!0){tO.dispatch({type:"RESET"})}async function tq(e){let{username:t,password:n}=e,o=_.H.getConfig().Auth?.Cognito,i={loginId:t,authFlowType:"USER_SRP_AUTH"};(0,b.$y)(o);let r=e.options?.clientMetadata;k(!!t,s.EmptySignInUsername),k(!!n,s.EmptySignInPassword);try{let{ChallengeName:e,ChallengeParameters:s,AuthenticationResult:a,Session:c}=await tf(t,n,r,o,es.o),d=tF(t);if(eS({signInSession:c,username:d,challengeName:e,signInDetails:i}),a)return await ea({username:d,...a,NewDeviceMetadata:await ts({userPoolId:o.userPoolId,userPoolEndpoint:o.userPoolEndpoint,newDeviceMetadata:a.NewDeviceMetadata,accessToken:a.AccessToken}),signInDetails:i}),eu(),await ec(),tL(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};return tN({challengeName:e,challengeParameters:s})}catch(t){eu(),tL(),(0,tD.e)(t);let e=tC(t.name);if(e)return e;throw t}}async function tk(e){let{username:t,password:n,options:o}=e,i=_.H.getConfig().Auth?.Cognito,r={loginId:t,authFlowType:"USER_PASSWORD_AUTH"};(0,b.$y)(i);let a=o?.clientMetadata;k(!!t,s.EmptySignInUsername),k(!!n,s.EmptySignInPassword);try{let{ChallengeName:e,ChallengeParameters:o,AuthenticationResult:s,Session:c}=await tg(tR,[t,n,a,i,es.o],t,es.o),d=tF(t);if(eS({signInSession:c,username:d,challengeName:e,signInDetails:r}),s)return await ea({...s,username:d,NewDeviceMetadata:await ts({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:s.NewDeviceMetadata,accessToken:s.AccessToken}),signInDetails:r}),eu(),await ec(),tL(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};return tN({challengeName:e,challengeParameters:o})}catch(t){eu(),tL(),(0,tD.e)(t);let e=tC(t.name);if(e)return e;throw t}}async function tB({username:e,clientMetadata:t,config:n,tokenOrchestrator:o,preferredChallenge:i,password:r,session:a}){let{userPoolId:c,userPoolClientId:d,userPoolEndpoint:p}=n,l=(0,tc.d)({username:e,userPoolId:c,userPoolClientId:d}),E={USERNAME:e};if(i){if("PASSWORD_SRP"===i)return k(!!r,s.EmptySignInPassword),tI({username:e,password:r,clientMetadata:t,config:n,tokenOrchestrator:o,authFlow:"USER_AUTH",preferredChallenge:i});"PASSWORD"===i&&(k(!!r,s.EmptySignInPassword),E.PASSWORD=r),E.PREFERRED_CHALLENGE=i}let u={AuthFlow:"USER_AUTH",AuthParameters:E,ClientMetadata:t,ClientId:d,UserContextData:l};a&&(u.Session=a);let x=(0,Z.R)({endpointResolver:(0,eo.o)({endpointOverride:p})}),m=await x({region:(0,B.J)(c),userAgentValue:J(O.BM.SignIn)},u);return tS(e),m}async function tH(e){let{username:t,password:n,options:o}=e,i=_.H.getConfig().Auth?.Cognito,r={loginId:t,authFlowType:"USER_AUTH"};(0,b.$y)(i);let a=o?.clientMetadata,c=o?.preferredChallenge;k(!!t,s.EmptySignInUsername);try{let e={username:t,config:i,tokenOrchestrator:es.o,clientMetadata:a,preferredChallenge:c,password:n},o=tO.getState();o.active&&o.username===t&&(e.session=o.session);let s=await tB(e),d=tF(t);if(eS({signInSession:s.Session,username:d,challengeName:s.ChallengeName,signInDetails:r}),s.AuthenticationResult)return await ea({username:d,...s.AuthenticationResult,NewDeviceMetadata:await ts({userPoolId:i.userPoolId,userPoolEndpoint:i.userPoolEndpoint,newDeviceMetadata:s.AuthenticationResult.NewDeviceMetadata,accessToken:s.AuthenticationResult.AccessToken}),signInDetails:r}),eu(),await ec(),tL(),{isSignedIn:!0,nextStep:{signInStep:"DONE"}};return tN({challengeName:s.ChallengeName,challengeParameters:s.ChallengeParameters,availableChallenges:"AvailableChallenges"in s?s.AvailableChallenges:void 0})}catch(t){eu(),tL(),(0,tD.e)(t);let e=tC(t.name);if(e)return e;throw t}}async function tV(e){tL(!1);let t=e.options?.authFlowType;switch(await tU(),t){case"USER_SRP_AUTH":default:return tq(e);case"USER_PASSWORD_AUTH":return tk(e);case"CUSTOM_WITHOUT_SRP":return tM(e);case"CUSTOM_WITH_SRP":return t_(e);case"USER_AUTH":return tH(e)}}function tz(e,t){let n;return o=>{n||e(...o),clearTimeout(n),n=setTimeout(()=>{n=void 0},t)}}let tW=tz(function(e,t,n){let o=Date.now(),i=setInterval(async()=>{if(Date.now()-o>18e4)clearInterval(i),n(new q.l({name:W.A0,message:"The account was not confirmed on time.",recoverySuggestion:"Try to verify your account by clicking the link sent your email or phone and then login manually."})),tL();else try{let n=await tV(e);"CONFIRM_SIGN_UP"!==n.nextStep.signInStep&&(t(n),clearInterval(i),tL())}catch(e){clearInterval(i),n(e),tL()}},5e3)},300),t$=tz(tG,300);async function tG(e,t,n){try{let n=e?.options?.authFlowType==="USER_AUTH"?await tH(e):await tV(e);t(n),tL()}catch(e){n(e),tL()}}function tK(e){return async()=>new Promise((t,n)=>{t$([e,t,n])})}var tY=n(9352);let tJ=()=>async e=>{if(e.statusCode>=300){let t=await (0,tY.F)(e);if((0,tD.e)(t),t.name===v.InvalidParameterException&&/'password'/.test(t.message)&&/Member must not be null/.test(t.message)){let e=s.EmptySignUpPassword,{message:t,recoverySuggestion:n}=L[e];throw new q.l({name:e,message:t,recoverySuggestion:n})}throw new q.l({name:t.name,message:t.message})}return(0,tY.Y)(e)},tZ=e=>(0,j.A)(Q.e,(0,X._)("SignUp"),tJ(),{...et.C,...e});async function tj(e){let{username:t,password:n,options:o}=e,i=_.H.getConfig().Auth?.Cognito,r=i?.signUpVerificationMethod??"code",{clientMetadata:a,validationData:c,autoSignIn:d}=e.options??{};(0,b.$y)(i),k(!!t,s.EmptySignUpUsername);let p="boolean"!=typeof d?d:void 0,l={username:t,options:p};p?.authFlowType!=="CUSTOM_WITHOUT_SRP"&&(l.password=n);let{userPoolId:E,userPoolClientId:u,userPoolEndpoint:x}=i,m=tZ({endpointResolver:(0,eo.o)({endpointOverride:x})}),h={Username:t,Password:void 0,UserAttributes:o?.userAttributes&&H(o?.userAttributes),ClientMetadata:a,ValidationData:c&&H(c),ClientId:u,UserContextData:(0,tc.d)({username:t,userPoolId:E,userPoolClientId:u})};n&&(h.Password=n);let{UserSub:g,CodeDeliveryDetails:S,UserConfirmed:I,Session:y}=await m({region:(0,B.J)(E),userAgentValue:J(O.BM.SignUp)},h);(p||!0===d)&&(tO.dispatch({type:"START"}),tO.dispatch({type:"SET_USERNAME",value:t}),tO.dispatch({type:"SET_SESSION",value:y}));let R={destination:S?.Destination,deliveryMedium:S?.DeliveryMedium,attributeName:S?.AttributeName},f=tO.getState().active;if(I)return f?(tK(l),{isSignUpComplete:!0,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN"},userId:g}):{isSignUpComplete:!0,nextStep:{signUpStep:"DONE"},userId:g};if(f){if("link"===r)return async()=>new Promise((e,t)=>{tW([l,e,t])}),{isSignUpComplete:!1,nextStep:{signUpStep:"COMPLETE_AUTO_SIGN_IN",codeDeliveryDetails:R},userId:g};!function(e){let t=V.f3.listen("auth-internal",async({payload:n})=>{if("confirmSignUp"===n.event){let o=n.data;o?.isSignUpComplete&&(V.f3.dispatch("auth-internal",{event:"autoSignIn"}),tK(e),t())}}),n=setTimeout(()=>{t(),clearTimeout(n),tL()},18e4)}(l)}return{isSignUpComplete:!1,nextStep:{signUpStep:"CONFIRM_SIGN_UP",codeDeliveryDetails:R},userId:g}}}}]);